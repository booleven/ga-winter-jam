[gd_scene load_steps=24 format=3 uid="uid://cq47c4rcow286"]

[ext_resource type="Script" uid="uid://5lqmbbfg0ywq" path="res://area/slots/grid.gd" id="4_8wavt"]
[ext_resource type="Texture2D" uid="uid://7d2wb1b1v0fc" path="res://resources/assets/slot/slot_machine.png" id="7_mxkie"]
[ext_resource type="Texture2D" uid="uid://d3xfrnwd55810" path="res://resources/assets/slot/background.png" id="8_3q2qy"]
[ext_resource type="Texture2D" uid="uid://bfn74bl6lpbk1" path="res://resources/assets/slot/slot_grid.png" id="8_v37ui"]
[ext_resource type="Script" uid="uid://ce2qpf48t48tx" path="res://scripts/color_shape.gd" id="9_0rqpl"]
[ext_resource type="Texture2D" uid="uid://do72usrclfgbr" path="res://resources/assets/slot/lever_shaft.png" id="9_v37ui"]
[ext_resource type="Shader" uid="uid://dc1iecysx73tm" path="res://resources/shaders/clip.gdshader" id="9_xpi8b"]
[ext_resource type="Script" uid="uid://4jnese2il8fy" path="res://area/slots/lever.gd" id="10_xus7s"]
[ext_resource type="Texture2D" uid="uid://lnjcd8sclpku" path="res://resources/assets/slot/lever_handle.png" id="11_hg167"]
[ext_resource type="Shader" uid="uid://cspqy8k7toorr" path="res://resources/shaders/barrel.gdshader" id="15_75l62"]
[ext_resource type="Texture2D" uid="uid://bsn2oyd7vflfi" path="res://resources/assets/slot/freeze_left.png" id="16_xus7s"]
[ext_resource type="Texture2D" uid="uid://ba3x81lyvt8ns" path="res://resources/assets/slot/freeze_middle.png" id="17_hg167"]
[ext_resource type="Texture2D" uid="uid://dvten5ft4mdw0" path="res://resources/assets/slot/freeze_right.png" id="18_75l62"]
[ext_resource type="Shader" uid="uid://bc0ku5feafpuy" path="res://resources/shaders/led.gdshader" id="20_2et7l"]
[ext_resource type="Script" uid="uid://c5wsux1x415fq" path="res://area/slots/state_machine.gd" id="23_kfsju"]
[ext_resource type="Script" uid="uid://ls7pcdk2khk2" path="res://area/slots/idle.gd" id="24_o3snp"]
[ext_resource type="Script" uid="uid://b7l048bugqhnn" path="res://area/slots/spin.gd" id="25_o3snp"]
[ext_resource type="Script" uid="uid://8k7pdclat4gy" path="res://area/slots/execute.gd" id="26_fkfjl"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ha2tw"]
shader = ExtResource("20_2et7l")
shader_parameter/grid_columns = 75
shader_parameter/grid_rows = 75
shader_parameter/led_brightness = 1.0
shader_parameter/led_radius = 0.80000001192093
shader_parameter/glow_size = 0.0
shader_parameter/glow_strength = 0.5
shader_parameter/color_quantization = 0.0
shader_parameter/background_color = Color(0.13725491, 0.21960784, 0.2901961, 1)
shader_parameter/background_opacity = 0.90000004275
shader_parameter/glow_pulse = 1.0
shader_parameter/curvature = 0.05
shader_parameter/enable_dither = true
shader_parameter/enable_flicker = true

[sub_resource type="ShaderMaterial" id="ShaderMaterial_xpi8b"]
shader = ExtResource("9_xpi8b")
shader_parameter/power = 1000.0
shader_parameter/up = 0.0
shader_parameter/down = 0.0
shader_parameter/left = 0.0
shader_parameter/right = 0.0
shader_parameter/up_clip = 0.0
shader_parameter/down_clip = 0.0
shader_parameter/left_clip = 0.0
shader_parameter/right_clip = 0.0

[sub_resource type="CircleShape2D" id="CircleShape2D_75l62"]
radius = 136.00368

[sub_resource type="ShaderMaterial" id="ShaderMaterial_0rqpl"]
shader = ExtResource("15_75l62")
shader_parameter/distortion_strength = 2.0
shader_parameter/curvature = 1.0

[sub_resource type="LabelSettings" id="LabelSettings_mxkie"]
font_size = 100

[node name="Slots" type="Node2D"]

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("current_state")]
script = ExtResource("23_kfsju")
current_state = NodePath("Idle")
metadata/_custom_type_script = "uid://buoxee4ryc121"

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("24_o3snp")
metadata/_custom_type_script = "uid://s3q1mykales"

[node name="Spin" type="Node" parent="StateMachine"]
script = ExtResource("25_o3snp")
metadata/_custom_type_script = "uid://s3q1mykales"

[node name="Execute" type="Node" parent="StateMachine"]
script = ExtResource("26_fkfjl")
metadata/_custom_type_script = "uid://s3q1mykales"

[node name="Background" type="Sprite2D" parent="."]
texture = ExtResource("8_3q2qy")
metadata/_edit_lock_ = true

[node name="LEDBackgrouund" type="Control" parent="."]
layout_mode = 3
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -368.20807
offset_top = -429.0
offset_right = 364.0
offset_bottom = 249.0
grow_horizontal = 2
grow_vertical = 0
size_flags_horizontal = 4
script = ExtResource("9_0rqpl")
shape = 1
color = Color(0.18039216, 0.28627452, 0.3764706, 1)
metadata/_custom_type_script = "uid://ce2qpf48t48tx"

[node name="PointsCounter" type="Label" parent="."]
offset_left = -227.0
offset_top = -374.0
offset_right = 214.0
offset_bottom = -237.0
theme_override_colors/font_color = Color(0.30211085, 0.6777984, 0.2877438, 1)
theme_override_font_sizes/font_size = 100
text = "0"
horizontal_alignment = 1

[node name="LEDShader" type="Control" parent="."]
material = SubResource("ShaderMaterial_ha2tw")
layout_mode = 3
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -331.0
offset_top = -429.0
offset_right = 331.0
offset_bottom = 213.0
grow_horizontal = 2
grow_vertical = 0
size_flags_horizontal = 4
script = ExtResource("9_0rqpl")
shape = 1
metadata/_custom_type_script = "uid://ce2qpf48t48tx"

[node name="SlotMachine" type="Sprite2D" parent="."]
position = Vector2(10, 52)
texture = ExtResource("7_mxkie")
metadata/_edit_lock_ = true

[node name="SlotGrid" type="Sprite2D" parent="."]
visible = false
position = Vector2(-10, 89)
texture = ExtResource("8_v37ui")
metadata/_edit_lock_ = true

[node name="LeverShaft" type="Sprite2D" parent="."]
material = SubResource("ShaderMaterial_xpi8b")
position = Vector2(563, 184)
texture = ExtResource("9_v37ui")

[node name="Lever" type="Area2D" parent="." node_paths=PackedStringArray("shaft")]
position = Vector2(579, -108)
script = ExtResource("10_xus7s")
max_pull_distance = 350.0
activation_threshold = 0.9
shaft = NodePath("../LeverShaft")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Lever"]
shape = SubResource("CircleShape2D_75l62")

[node name="LeverHandle" type="Sprite2D" parent="Lever"]
texture = ExtResource("11_hg167")

[node name="Grid" type="CanvasGroup" parent="."]
position = Vector2(-249, -126)
script = ExtResource("4_8wavt")
spacing = Vector2(250, 200)
scaling = 0.7
barrel = SubResource("ShaderMaterial_0rqpl")

[node name="FreezeButtons" type="Node2D" parent="."]
position = Vector2(11, 52)

[node name="Freeze1" type="TextureButton" parent="FreezeButtons"]
offset_left = -313.0
offset_top = 354.0
offset_right = -163.0
offset_bottom = 454.0
texture_normal = ExtResource("16_xus7s")
metadata/_edit_use_anchors_ = true

[node name="Freeze2" type="TextureButton" parent="FreezeButtons"]
offset_left = -80.0
offset_top = 362.0
offset_right = 70.0
offset_bottom = 462.0
texture_normal = ExtResource("17_hg167")
metadata/_edit_use_anchors_ = true

[node name="Freeze3" type="TextureButton" parent="FreezeButtons"]
offset_left = 147.0
offset_top = 356.0
offset_right = 297.0
offset_bottom = 456.0
texture_normal = ExtResource("18_75l62")
metadata/_edit_use_anchors_ = true

[node name="SpinsCounter" type="Label" parent="."]
offset_left = -609.0
offset_top = -85.0
offset_right = -495.0
offset_bottom = 56.0
text = "5"
label_settings = SubResource("LabelSettings_mxkie")
metadata/_edit_use_anchors_ = true

[node name="Label" type="Label" parent="."]
offset_left = -907.0
offset_top = -489.0
offset_right = -479.0
offset_bottom = -420.0
theme_override_font_sizes/font_size = 50
text = "current state"

[connection signal="finished" from="StateMachine/Idle" to="StateMachine" method="_on_idle_finished"]
[connection signal="finished" from="StateMachine/Execute" to="StateMachine" method="_on_execute_finished"]
[connection signal="pulled" from="Lever" to="." method="_on_lever_pulled"]
[connection signal="pulled" from="Lever" to="StateMachine/Idle" method="_on_lever_pulled"]
[connection signal="pressed" from="FreezeButtons/Freeze1" to="StateMachine/Idle" method="_on_freeze_1_pressed"]
[connection signal="pressed" from="FreezeButtons/Freeze2" to="StateMachine/Idle" method="_on_freeze_2_pressed"]
[connection signal="pressed" from="FreezeButtons/Freeze3" to="StateMachine/Idle" method="_on_freeze_3_pressed"]
